<!-- å·¦ä¾§é¡¶éƒ¨æ»‘å…¥å¼¹çª—ï¼ˆå®Œå…¨æ”¶å›ç‰ˆï¼‰ -->
<div id="copyToast" class="snack-left-top">å“å˜¿ï¼å¤åˆ¶æˆåŠŸğŸ¬</div>

<script>
/* ====== ä»£ç å—å¤åˆ¶ ====== */
(() => {
  const toast = document.getElementById('copyToast');
  const show = (msg = 'å“å˜¿ï¼å¤åˆ¶æˆåŠŸğŸ¬') => {
    toast.textContent = msg;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 2000);
  };

  /* 1. ä»£ç å—æŒ‰é’®ç‚¹å‡» */
  document.querySelector('.article-content').addEventListener('click', e => {
    if (!e.target.matches('.copyCodeButton')) return;
    const wrap  = e.target.closest('pre') || e.target.closest('.highlight');
    const codeTd = wrap?.querySelector('td:nth-child(2)') || wrap;
    const text = codeTd ? codeTd.textContent.trim() : '';
    navigator.clipboard.writeText(text)
      .then(() => show())
      .catch(err => alert('å¤åˆ¶å¤±è´¥ï¼š'+err));
  });

  /* 2. å…¨å±€é€‰ä¸­å¤åˆ¶ï¼ˆä»»ä½•æ–‡æœ¬ï¼‰ */
  document.addEventListener('copy', (e) => {
    e.preventDefault();
    const selectedText = window.getSelection().toString().trim();
    if (!selectedText) return;
    navigator.clipboard.writeText(selectedText)
      .then(() => show('å“å˜¿ï¼å¤åˆ¶æˆåŠŸğŸ¬'))
      .catch(err => console.warn(err));
  });
})();
</script>

<style>
/* ===== å¤åˆ¶æŒ‰é’® ===== */
.copyCodeButton{
  position:absolute;top:8px;right:8px;border-radius:4px;border:1px solid #333;
  background:#3d3c3c;color:#fff;padding:4px 8px;font-size:12px;cursor:pointer;
  transition:background .2s;
}
.copyCodeButton:hover{background:var(--hover-text-color);color:#fff}

/* ===== å·¦ä¾§é¡¶éƒ¨æ»‘å…¥ Toast ===== */
.snack-left-top{
  position:fixed;
  left:20px;                                      /* å·¦ä¾§ 20 px è¾¹è· */
  top:calc(20px + env(safe-area-inset-top, 0px)); /* é¡¶éƒ¨ 20 px + å®‰å…¨åŒº */
  transform:translateX(calc(-100% - 20px));       /* å®Œå…¨è—åœ¨å±å¹•å¤– */
  max-width:70%;
  margin:0;
  border:none;
  border-radius:8px;
  padding:10px 16px;
  background:var(--hover-text-color);
  color:#fff;
  box-shadow:4px 4px 14px rgba(0,0,0,.35);
  z-index:9999;
  font-size:16px;
  font-weight:bold;
  line-height:1.4;
  white-space:nowrap;
  transition:transform .35s cubic-bezier(.4,0,.2,1);
}

/* æ˜¾ç¤ºæ€ï¼šæ»‘å…¥åˆ° left:20px ä½ç½® */
.snack-left-top.show{
  transform:translateX(0);
}
</style>