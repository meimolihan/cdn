<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>

<div id="aplayer"></div>

<script>
    // 将 {{.Site.Home.Permalink }} 替换为固定链接
    const home = 'https://music.meimolihan.eu.org/';
    const songs = [
        '蜉蝣志-石岩',
        '来生别再相遇-海来阿木',
        '香水-谢霆锋',
        '忘川彼岸-零一九零贰',
        '背着风流泪-文夫',
        '苟活-周文凯',
        '我爱他-丁当',
        '苟活之重生-周文凯',
        '最好的安排-曲婉婷',
        '望故乡-文夫',
        '骗子-文夫',
        '最后一次的温柔-田园',
        '我把往事化如烟-侯泽润',
        '亲爱的你啊-任素汐',
        '单身万岁-演员雪姐',
        '借口-侯泽润',
        '一句先苦后甜-侯泽润',
        '你怎么舍得我难过-正在进行石女士',
        '九万字-张靓颖、摩登兄弟刘宇宁',
        '老男孩-筷子兄弟', 
        '雨蝶-李翊君', 
        'JarOfLove-曲婉婷', 
        '我的歌声里-曲婉婷', 
        '跳楼机-张靓颖.王以太', 
        '浪子的心情-十二大美女', 
        '空荡的酒杯(天籁版)-洋澜一', 
        '谢谢你的爱1999-谢霆锋', 
        '月亮照山川-窝窝', 
        '离别开出花-就是南方凯', 
        '爱是你我-刀郎、云朵', 
        '你在他乡还好吗-大双二双',
        '执子之手-宝石Gem', 
        '这些年在忙什么-田园', 
        '平凡日子里的挣扎-小璐', 
        '无爱情歌-王娜', 
        '人间疾苦-马健涛', 
        '大风吹倒梧桐树-侯泽润、田园', 
        '跳楼机-en', 
        '一路生花-温奕心', 
        '碎银几两-轩东', 
        '此生无憾-金钰儿', 
        '搀扶-马健涛', 
        '敬往事一杯-侯泽润', 
        '人间一路-青木时光', 
        '别怕我伤心-张信哲', 
        '大东北我的家乡-何玉', 
        '陪我过个冬-燃', 
        '我期待的不是雪-张妙格', 
        '苦命的人-刘阳阳', 
        '爱情恰恰-十二大美女', 
        '不要慌，太阳下山有月光-张含韵', 
        '往事只能回味-周虹', 
        '花妖-刀郎', 
        '一身傲骨不低头-侯泽润', 
        '罗刹海市-刀郎', 
        '怀念战友-刀郎', 
        '西海情歌-刀郎', 
        '我的春风何时来-李贺', 
        '爱我还是他-刘大拿', 
        '爱你十分泪七分-裘海正',
        '大不了-花姐',
        '白鸽乌鸦相爱的戏码-艾辰',
        '爱意藏风里-何雨溪',
        '忠孝东路走九遍-动力火车',
        '这一路风太大-原来是夏夏',
        '天高任鸟飞-侯泽润',
        '月光凉.落满窗-泡芙芙Scarlett',
        '败-侯泽润',
        '一万个理由-郑源', 
        '一亿个伤心-蒙面哥', 
        '一无所有的年纪-侯泽润', 
        '万有引力-汪苏泷', 
        '人间半途-刘阳阳', 
        '人间烟火-程响', 
        '伤心剖半-邓典', 
        '伤心太平洋-任贤齐', 
        '你别慌余生还长-任夏', 
        '假如我不再善良-郑畅业', 
        '冲动的惩罚-刀郎', 
        '凡夫俗子-范茹', 
        '别说我的眼泪你无所谓-东来东往', 
        '可能-程响', 
        '听-张杰', 
        '喀什噶尔胡杨-刀郎', 
        '因为爱所以爱-谢霆锋', 
        '土坡上的狗尾草-卢润泽', 
        '多想做个哑巴-侯泽润', 
        '失恋阵线联盟-草蜢', 
        '妈妈我想回家-曾抖抖', 
        '小模样-张冬玲', 
        '年少的你啊-浩然H.R', 
        '归途的光-诺爷Plus', 
        '心态才是你风水-艺凌', 
        '我也不想活得太累-郑畅业', 
        '我真怕自己哪天倒下-张良', 
        '手心里的温柔-刀郎', 
        '换个方向风景会更好看-杨一琪', 
        '放手也是一种成全-郑畅业', 
        '星星点灯-大波浪', 
        '星河万里-Rom邢锐', 
        '有点甜-汪苏泷.BY2', 
        '望故乡-刘阳阳', 
        '海边探戈-王鹤棣', 
        '火力全开-王力宏', 
        '生活没有说明书-洛什么洛', 
        '破碎的梦-陈柏曦', 
        '秋风经过-任夏', 
        '第51次原谅-刘艺雯', 
        '老人与海-汪苏泷.王心凌', 
        '胡广生-任素汐', 
        '苹果香-狼戈', 
        '西楼儿女-岳云鹏', 
        '谁明浪子心-王杰', 
        '路灯下点烟时没有打火机-王永清', 
        '过了河就拆桥-成学迅', 
        '野狼disco-宝石Gem', 
        '除了生死都是擦伤-侯泽润', 
    ];
    let audios = [];
    // 遍历歌曲列表
    songs.forEach((item) => {
        const songInfo = item.split('-');
        audios.push({
            name: songInfo[0],
            artist: songInfo[1],
            url: home + item + '/song.mp3',
            cover: home + item + '/cover.jpg',
            lrc: home + item + '/lyric.lrc'
        });
    });

    const ap = new APlayer({
        container: document.getElementById('aplayer'),
        fixed: true,
        lrcType: 3,
        audio: audios
    });

    /**
     * 页面销毁前监听
     */
    window.onbeforeunload = () => {
        // 将播放信息用对象封装，并存入到localStorage中
        const playInfo = {
            index: ap.list.index,
            currentTime: ap.audio.currentTime,
            paused: ap.paused
        };
        localStorage.setItem("playInfo", JSON.stringify(playInfo));
    };

    /**
     * 页面加载后监听
     */
    window.onload = () => {
        // 从localStorage取出播放信息
        const playInfo = JSON.parse(localStorage.getItem("playInfo"));
        if (!playInfo) {
            return;
        }
        // 切换歌曲
        ap.list.switch(playInfo.index);
        // 等待500ms再执行下一步(切换歌曲需要点时间，不能立马调歌曲进度条)
        setTimeout(() => {
            // 调整时长
            ap.seek(playInfo.currentTime);
            // 是否播放
            if (!playInfo.paused) {
                ap.play()
            }
        }, 500);
    };
</script>